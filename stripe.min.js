"use latest";function s(a){app[a.m]("/"+a.r+"/"+a.f,(b,c)=>{var d=b.webtaskContext;const e=d.secrets.stripeSecretKey,f=d(e);f[a.r][a.f](a.a(b),(a,b)=>{return a?c.json(a):void c.json(b)})})}import a from"express";import{fromExpress as b}from"webtask-tools";import c from"body-parser";import d from"stripe@4.14.0";var app=a();app.use(c.urlencoded({extended:!0})),app.use(c.json()),s({m:"post",r:"customers",f:"create",a:a=>({source:a.body.stripeToken,business_vat_id:a.body.business_vat_id,coupon:a.body.coupon,description:a.body.description,email:a.body.email,metadata:a.body.metadata,shipping:a.body.shipping})}),s({m:"get",r:"customers",f:"retrieve",a:a=>a.query.customerid}),s({m:"post",r:"customers",f:"update",a:a=>(a.body.customerid,{source:a.body.stripeToken,business_vat_id:a.body.business_vat_id,coupon:a.body.coupon,description:a.body.description,email:a.body.email,metadata:a.body.metadata,shipping:a.body.shipping})}),s({m:"post",r:"customers",f:"del",a:a=>a.query.customerid}),s({m:"get",r:"customers",f:"list",a:a=>({created:a.query.created,ending_before:a.query.ending_before,limit:a.query.limit,starting_after:a.query.starting_after})}),s({m:"post",r:"customers",f:"createSource",a:a=>(a.body.customerid,{source:a.body.stripeToken,metadata:a.body.metadata})}),s({m:"get",r:"customers",f:"retrieveCard",a:a=>(a.query.customerid,a.query.cardid)}),s({m:"post",r:"customers",f:"updateCard",a:a=>(a.query.customerid,a.query.cardid,{address_city:a.body.address_city,address_country:a.body.address_country,address_line1:a.body.address_line1,address_line2:a.body.address_line2,address_state:a.body.address_state,address_zip:a.body.address_zip,exp_month:a.body.exp_month,exp_year:a.body.exp_year,metadata:a.body.metadata,name:a.body.name})}),s({m:"post",r:"customers",f:"deleteCard",a:a=>(a.query.customerid,a.query.cardid)}),s({m:"get",r:"customers",f:"listCards",a:a=>(a.query.customer,{ending_before:a.query.ending_before,limit:a.query.limit,starting_after:a.query.starting_after})}),s({m:"post",r:"subscriptions",f:"create",a:a=>({customer:a.body.customer,plan:a.body.plan,application_fee_percent:a.body.application_fee_percent,coupon:a.body.coupon,items:a.body.items,metadata:a.body.metadata,plan:a.body.plan,prorate:a.body.prorate,quantity:a.body.quantity,source:a.body.source,trial_end:a.body.trial_end,trial_period_days:a.body.trial_period_days})}),s({m:"get",r:"subscriptions",f:"retrieve",a:a=>a.query.subscriptionid}),s({m:"post",r:"subscriptions",f:"update",a:a=>(a.body.subscriptionid,{plan:a.body.plan,application_fee_percent:a.body.application_fee_percent,coupon:a.body.coupon,items:a.body.items,metadata:a.body.metadata,plan:a.body.plan,prorate:a.body.prorate,quantity:a.body.quantity,source:a.body.source,trial_end:a.body.trial_end,trial_period_days:a.body.trial_period_days})}),s({m:"post",r:"subscriptions",f:"del",a:a=>a.query.subscriptionid}),s({m:"get",r:"subscriptions",f:"list",a:a=>({customer:a.query.customer,ending_before:a.query.ending_before,limit:a.query.limit,starting_after:a.query.starting_after,plan:a.query.plan,status:a.query.status})}),module.exports=b(app);